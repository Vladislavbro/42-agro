# Структура Проекта "Агро-Отчеты"

Этот документ описывает предлагаемую структуру каталогов и файлов для проекта обработки отчетов из WhatsApp с использованием Gemini и Google Sheets.

## Основные Каталоги и Файлы

-   **/app**: Содержит основную логику приложения.
    -   **/app/message_processing**: Модули для обработки входящих сообщений (например, из WhatsApp).
        -   `parser.py`: Функции для разбора (парсинга) текстовых сообщений. Содержит логику для извлечения предварительной информации из текста перед отправкой в Gemini.
        -   `validator.py`: Функции для проверки формата и содержимого сообщений.
    -   **/app/gemini_integration**: Модули для взаимодействия с Google Gemini API.
        -   `client.py`: Настройка клиента Gemini API и логика отправки запросов.
        -   `prompt_builder.py`: Функции для формирования промптов для Gemini на основе разобранных сообщений и задачи извлечения данных.
        -   `extractor.py`: Функции для извлечения структурированных данных (JSON) из ответа Gemini.
    -   **/app/google_sheets_integration**: Модули для взаимодействия с Google Sheets API.
        -   `client.py`: Настройка клиента Google Sheets API (аутентификация, работа с таблицами).
        -   `writer.py`: Функции для записи извлеченных JSON-данных в указанный лист Google Sheets.
    -   `main.py`: Основная точка входа в приложение. Оркестрирует весь процесс: получение сообщения -> парсинг -> валидация -> вызов Gemini -> извлечение данных -> запись в Google Sheets. Может быть реализован как скрипт, веб-сервис (если планируется API) или функция для облачной платформы.
    -   `config.py`: Управление конфигурацией (API-ключи, ID таблиц, настройки Gemini, пути и т.д.). Лучше использовать переменные окружения для чувствительных данных.
-   **/data**: Для хранения примеров данных, справочников и т.п.
    -   `samples/`: Примеры сообщений для тестирования и отладки.
    -   `mappings/`: Файлы с возможными сопоставлениями (например, аббревиатуры культур -> полные названия, если потребуется).
-   **/notebooks**: Jupyter-ноутбуки для экспериментов, тестирования промптов Gemini, анализа данных (например, `gemini-test.ipynb`).
-   **/tests**: Каталог для юнит- и интеграционных тестов.
    -   **/tests/message_processing**: Тесты для парсера и валидатора.
    -   **/tests/gemini_integration**: Тесты для взаимодействия с Gemini (возможно, с использованием моков).
    -   **/tests/google_sheets_integration**: Тесты для взаимодействия с Google Sheets (возможно, с использованием моков).
-   `requirements.txt`: Список зависимостей проекта (библиотеки Python).
-   `README.md`: Общее описание проекта, инструкции по установке, настройке и запуску.
-   `STRUCTURE.md`: Этот файл.
-   `.env.example`: Пример файла для переменных окружения.
-   `.gitignore`: Стандартный файл `.gitignore` для Python-проектов.

## Пояснения

-   **Модульность**: Разделение на `message_processing`, `gemini_integration`, `google_sheets_integration` позволяет независимо разрабатывать и тестировать каждую часть системы.
-   **Конфигурация**: Вынесение настроек в `config.py` и использование переменных окружения (`.env`) упрощает управление конфигурацией для разных сред (разработка, продакшн).
-   **Тестирование**: Наличие каталога `tests` подчеркивает важность автоматизированного тестирования.
-   **Эксперименты**: Каталог `notebooks` удобен для быстрой проверки гипотез и отладки взаимодействия с API.

Эта структура является отправной точкой и может быть адаптирована по мере развития проекта. 